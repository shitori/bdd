CREATE table "UTILISATEUR" (
    "ID"                 NUMBER NOT NULL,
    "IDCOUPLE"           NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    "PSEUDO"             VARCHAR2(50) NOT NULL,
    "PRENOM"             VARCHAR2(50) NOT NULL,
    "ADRESSEMAIL"        VARCHAR2(255) NOT NULL,
    "VILLE"              VARCHAR2(50) NOT NULL,
    "PAYS"               VARCHAR2(50) NOT NULL,
    "MDP"                VARCHAR2(255) NOT NULL,
    "SEXE"               CHAR(1) NOT NULL,
    "ANNIVERSAIRE"       DATE NOT NULL,
    "NUMTEL"             VARCHAR2(10) NOT NULL,
    "DATEINSCRIPTION"    TIMESTAMP WITH LOCAL TIME ZONE NOT NULL,
    "DATEDESINSCRIPTION" TIMESTAMP WITH LOCAL TIME ZONE,
    constraint  "UTILISATEUR_PK" primary key ("ID")
);

CREATE table "PAGE" (
    "ID"         NUMBER NOT NULL,
    "TITRE"      VARCHAR2(255) NOT NULL,
    "VISIBILITE" NUMBER(1) NOT NULL,
    "ESTGROUPE"  NUMBER(1) NOT NULL,
    constraint  "PAGE_PK" primary key ("ID")
);

CREATE table "MEMBRE" (
    "IDUTILISATEUR" NUMBER NOT NULL,
    "IDPAGE"        NUMBER NOT NULL
);

alter table "MEMBRE" add constraint "MEMBRE_PK" primary key ("IDUTILISATEUR","IDPAGE");

ALTER TABLE "MEMBRE" ADD CONSTRAINT "MEMBRE_FK"
FOREIGN KEY ("IDUTILISATEUR")
REFERENCES "UTILISATEUR" ("ID")
ON DELETE CASCADE;

ALTER TABLE "MEMBRE" ADD CONSTRAINT "MEMBRE_FK2"
FOREIGN KEY ("IDPAGE")
REFERENCES "PAGE" ("ID")
ON DELETE CASCADE;

CREATE table "PUBLICATION" (
    "ID"                NUMBER NOT NULL,
    "IDPAGE"            NUMBER NOT NULL,
    "IDUTILISATEUR"     NUMBER NOT NULL,
    "IDPEREPUBLICATION" NUMBER,
    "TITRE"             VARCHAR2(255) NOT NULL,
    "TEXTE"             LONG NOT NULL,
    "DATEPUBLICATION"   TIMESTAMP WITH LOCAL TIME ZONE NOT NULL,
    constraint  "PUBLICATION_PK" primary key ("ID")
);

ALTER TABLE "PUBLICATION" ADD CONSTRAINT "PUBLICATION_FK"
FOREIGN KEY ("IDPAGE")
REFERENCES "PAGE" ("ID")
ON DELETE CASCADE;

CREATE table "AMI" (
    "IDUTILISATEUR1" NUMBER NOT NULL,
    "IDUTILISATEUR2" NUMBER NOT NULL,
    "DEBUTLIAISON"   DATE NOT NULL
);

alter table "AMI" add constraint  "AMI_PK" primary key ("IDUTILISATEUR1","IDUTILISATEUR2");

ALTER TABLE "AMI" ADD CONSTRAINT "AMI_FK"
FOREIGN KEY ("IDUTILISATEUR1")
REFERENCES "UTILISATEUR" ("ID")
ON DELETE CASCADE;

ALTER TABLE "AMI" ADD CONSTRAINT "AMI_FK2"
FOREIGN KEY ("IDUTILISATEUR2")
REFERENCES "UTILISATEUR" ("ID")
ON DELETE CASCADE;

CREATE table "MESSAGE" (
    "ID"             NUMBER NOT NULL,
    "IDUTILISATEUR1" NUMBER NOT NULL,
    "IDUTILISATEUR2" NUMBER NOT NULL,
    "TEXTE"          LONG NOT NULL,
    "DATEENVOI"      TIMESTAMP WITH LOCAL TIME ZONE NOT NULL,
    constraint  "MESSAGE_PK" primary key ("ID")
);

ALTER TABLE "MESSAGE" ADD CONSTRAINT "MESSAGE_FK"
FOREIGN KEY ("IDUTILISATEUR1")
REFERENCES "UTILISATEUR" ("ID")
ON DELETE CASCADE;

ALTER TABLE "MESSAGE" ADD CONSTRAINT "MESSAGE_FK2"
FOREIGN KEY ("IDUTILISATEUR2")
REFERENCES "UTILISATEUR" ("ID")
ON DELETE CASCADE;

CREATE table "AIMEPUBLICATIONS" (
    "IDUTILISATEUR" NUMBER NOT NULL,
    "IDPUBLICATION" NUMBER NOT NULL
);

alter table "AIMEPUBLICATIONS" add constraint  "AIMEPUBLICATIONS_PK" primary key ("IDUTILISATEUR","IDPUBLICATION");

ALTER TABLE "AIMEPUBLICATIONS" ADD CONSTRAINT "AIMEPUBLICATIONS_FK"
FOREIGN KEY ("IDUTILISATEUR")
REFERENCES "UTILISATEUR" ("ID")
ON DELETE CASCADE;

ALTER TABLE "AIMEPUBLICATIONS" ADD CONSTRAINT "AIMEPUBLICATIONS_FK2"
FOREIGN KEY ("IDPUBLICATION")
REFERENCES "PUBLICATION" ("ID")
ON DELETE CASCADE;

CREATE table "AIMEPAGES" (
    "IDUTILISATEUR" NUMBER NOT NULL,
    "IDPAGE"        NUMBER NOT NULL
);

alter table "AIMEPAGES" add constraint  "AIMEPAGES_PK" primary key ("IDUTILISATEUR","IDPAGE");

ALTER TABLE "AIMEPAGES" ADD CONSTRAINT "AIMEPAGES_FK"
FOREIGN KEY ("IDUTILISATEUR")
REFERENCES "UTILISATEUR" ("ID")
ON DELETE CASCADE;

ALTER TABLE "AIMEPAGES" ADD CONSTRAINT "AIMEPAGES_FK2"
FOREIGN KEY ("IDPAGE")
REFERENCES "PAGE" ("ID")
ON DELETE CASCADE;
